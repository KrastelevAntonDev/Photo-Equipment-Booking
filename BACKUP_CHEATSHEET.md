# üì¶ –ë–≠–ö–ê–ü–´ - –®–ø–∞—Ä–≥–∞–ª–∫–∞

## üöÄ –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (—Å –±—ç–∫–∞–ø–∞–º–∏):
```bash
./scripts/deploy.sh
```
**–°–æ–∑–¥–∞—Å—Ç –±—ç–∫–∞–ø—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!**

---

## üìÅ Uploads (—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏)

### –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø:
```bash
./scripts/backup-uploads-volume.sh
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:
```bash
./scripts/restore-uploads-volume.sh uploads_20241216_020000.tar.gz
```

### –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è:
```
/backups/uploads/uploads_YYYYMMDD_HHMMSS.tar.gz
```

---

## üóÑÔ∏è MongoDB (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)

### –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø:
```bash
./scripts/backup-mongodb.sh
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:
```bash
./scripts/restore-mongodb.sh mongodb_backup_20241216_030000.tar.gz
```

### –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è:
```
/backups/mongodb/mongodb_backup_YYYYMMDD_HHMMSS.tar.gz
```

---

## üìã –ß—Ç–æ –±—ç–∫–∞–ø–∏—Ç—Å—è

### Uploads:
- üì∏ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (`/uploads/equipment/`)
- üè† –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å—Ç—É–¥–∏–π (`/uploads/rooms/`)

### MongoDB:
- üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`users`)
- üìÖ –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (`bookings`)
- üé• –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (`equipment`)
- üè¢ –°—Ç—É–¥–∏–∏ (`rooms`)
- üíÑ –ì—Ä–∏–º—ë—Ä–Ω—ã–µ (`makeuprooms`)
- üí≥ –ü–ª–∞—Ç–µ–∂–∏ (`payment`)
- üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (`notifications`)
- üìù –§–æ—Ä–º—ã (`form`)
- üì± SMS (`sms_messages`)
- üîê –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (`admins`)

---

## ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (cron)

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
crontab -e
```

### –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫–∏:
```bash
# Uploads - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00
0 2 * * * cd /path/to/project && ./scripts/backup-uploads-volume.sh >> /var/log/uploads-backup.log 2>&1

# MongoDB - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00
0 3 * * * cd /path/to/project && ./scripts/backup-mongodb.sh >> /var/log/mongodb-backup.log 2>&1
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–∞–ø–æ–≤

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –±—ç–∫–∞–ø—ã:
```bash
# Uploads
ls -lht /backups/uploads/ | head -5

# MongoDB
ls -lht /backups/mongodb/ | head -5
```

### –†–∞–∑–º–µ—Ä –±—ç–∫–∞–ø–æ–≤:
```bash
du -sh /backups/uploads/
du -sh /backups/mongodb/
```

---

## üÜò –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö:

1. **–ù–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –±—ç–∫–∞–ø:**
   ```bash
   ls -lht /backups/uploads/
   ls -lht /backups/mongodb/
   ```

2. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å uploads:**
   ```bash
   ./scripts/restore-uploads-volume.sh uploads_DATE.tar.gz
   ```

3. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å MongoDB:**
   ```bash
   ./scripts/restore-mongodb.sh mongodb_backup_DATE.tar.gz
   ```

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å:**
   ```bash
   docker compose restart
   ```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

### ‚úÖ –î–ï–õ–ê–¢–¨:
- –ë—ç–∫–∞–ø–∏—Ç—å –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —á—Ç–æ –±—ç–∫–∞–ø—ã —Å–æ–∑–¥–∞—é—Ç—Å—è
- –•—Ä–∞–Ω–∏—Ç—å –±—ç–∫–∞–ø—ã –º–∏–Ω–∏–º—É–º 30 –¥–Ω–µ–π
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑ –≤ –º–µ—Å—è—Ü

### ‚ùå –ù–ï –î–ï–õ–ê–¢–¨:
- –£–¥–∞–ª—è—Ç—å –±—ç–∫–∞–ø—ã –≤—Ä—É—á–Ω—É—é
- –ò–∑–º–µ–Ω—è—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—ç–∫–∞–ø–æ–≤
- –•—Ä–∞–Ω–∏—Ç—å –±—ç–∫–∞–ø—ã —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ
- –ó–∞–±—ã–≤–∞—Ç—å –ø—Ä–æ –±—ç–∫–∞–ø—ã

---

## üìä –•—Ä–∞–Ω–µ–Ω–∏–µ

| –¢–∏–ø | –ü—É—Ç—å | –•—Ä–∞–Ω–µ–Ω–∏–µ | –†–∞–∑–º–µ—Ä |
|-----|------|----------|--------|
| Uploads | `/backups/uploads/` | 30 –¥–Ω–µ–π | ~50-200 MB |
| MongoDB | `/backups/mongodb/` | 30 –¥–Ω–µ–π | ~1-5 MB |

---

## üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏—è 3-2-1

- **3** –∫–æ–ø–∏–∏ –¥–∞–Ω–Ω—ã—Ö (production + 2 –±—ç–∫–∞–ø–∞)
- **2** —Ä–∞–∑–Ω—ã—Ö –Ω–æ—Å–∏—Ç–µ–ª—è (–ª–æ–∫–∞–ª—å–Ω—ã–π –¥–∏—Å–∫ + –æ–±–ª–∞–∫–æ)
- **1** –∫–æ–ø–∏—è off-site (–Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ)

### –ü—Ä–∏–º–µ—Ä:
```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –±—ç–∫–∞–ø—ã –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
rsync -avz /backups/ backup-server:/backups/

# –ò–ª–∏ –≤ –æ–±–ª–∞–∫–æ (S3)
aws s3 sync /backups/ s3://my-backups/
```

---

## üìû –õ–æ–≥–∏

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –±—ç–∫–∞–ø–æ–≤:
```bash
tail -f /var/log/uploads-backup.log
tail -f /var/log/mongodb-backup.log
```

### –ï—Å–ª–∏ –±—ç–∫–∞–ø –Ω–µ —Å–æ–∑–¥–∞–ª—Å—è:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞: `chmod +x scripts/*.sh`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ: `df -h`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `tail -f /var/log/*.log`
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

## ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –í—Å—ë –ª–∏ –û–ö?
./scripts/backup-uploads-volume.sh && \
./scripts/backup-mongodb.sh && \
echo "‚úÖ –í—Å–µ –±—ç–∫–∞–ø—ã —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ!"
```
